server:
  port: 8000

jwt:
  secret: ${JWT_SECRET_KEY}

spring:
  application:
    name: api-gateway
  main:
    allow-bean-definition-overriding: true
    web-application-type: reactive
  cloud:
    compatibility-verifier:
      enabled: false
    gateway:
      server:
        webflux:
          default-filters:
            - StripPrefix=1
          routes:
            - id: auth-service-route
              uri: http://user-service:8080
              predicates:
                - Path=/api/auth/**
              filters:
                - StripPrefix=1
            - id: user-service-route
              uri: http://user-service:8080
              predicates:
                - Path=/api/user/**
              filters:
                - StripPrefix=1
            - id: vote-service-route
              uri: http://vote-service:8080
              predicates:
                - Path=/api/vote/**
              filters:
                - StripPrefix=1
            - id: trading-service-route
              uri: http://trading-service:8080
              predicates:
                - Path=/api/trading/**
              filters:
                - StripPrefix=1
            - id: pay-service-route
              uri: http://pay-service:8080
              predicates:
                - Path=/api/pay/**
              filters:
                - StripPrefix=1

  autoconfigure:
    exclude:
      - org.springframework.boot.autoconfigure.orm.jpa.HibernateJpaAutoConfiguration
      - org.springframework.boot.autoconfigure.data.jpa.JpaRepositoriesAutoConfiguration
      - org.springframework.boot.autoconfigure.jdbc.DataSourceAutoConfiguration
      - org.springframework.boot.autoconfigure.jdbc.DataSourceTransactionManagerAutoConfiguration
      - org.springframework.boot.autoconfigure.sql.init.SqlInitializationAutoConfiguration
      - org.springframework.boot.autoconfigure.transaction.TransactionAutoConfiguration

  datasource:
    url: ""
    username: ""
    password: ""
    driver-class-name: ""

logging:
  level:
    root: INFO
    org.springframework.cloud.gateway: INFO
    org.springframework.web.reactive: INFO
    reactor.netty: INFO
    com.example.api_gateway: DEBUG

---

spring:
  config:
    activate:
      on-profile: "dev"
  data:
    redis:
      host: ${app.redis.host:localhost}
      port: ${app.redis.port:6379}
      password: ${app.redis.password:togather1234}

jwt:
  secret: ${app.jwt.secret:TogatherSecretkey}
server:
  port: 8000

---

spring:
  config:
    activate:
      on-profile: "main"
  data:
    redis:
      host: ${SPRING_DATA_REDIS_HOST:redis}
      port: ${SPRING_DATA_REDIS_PORT:6379}
      password: ${SPRING_DATA_REDIS_PASSWORD:}
      timeout: 5000ms
      connect-timeout: 5000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0
          max-wait: 5000ms
        shutdown-timeout: 100ms

jwt:
  secret: ${JWT_SECRET_KEY:TogatherSecretkey}
server:
  port: 8000